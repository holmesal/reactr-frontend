// Generated by CoffeeScript 1.6.2
(function() {
  define(['jquery', 'underscore', 'backbone', 'handlebars', 'text!templates/editControl.html'], function($, _, Backbone, Handlebars, EditControlTemplate) {
    var EditControlView;

    EditControlView = Backbone.View.extend({
      el: '#pane-right',
      template: Handlebars.compile(EditControlTemplate),
      events: {
        'click .display-icon-container': 'iconChosen',
        'keyup #input-name': 'nameUpdate',
        'keyup #input-description': 'descriptionUpdate',
        'click #saveReturn': 'saveReturn'
      },
      initialize: function() {
        var _this = this;

        this.listenTo(this.model, 'change:icon', this.render);
        this.animateIn();
        return $(document).keypress(function(e) {
          if (e.keyCode === 13) {
            return _this.saveReturn();
          }
        });
      },
      animateIn: function() {
        var _this = this;

        return $('#pane-right').animate({
          opacity: 0
        }, 200, function() {
          $('.control').animate({
            opacity: 1
          }, 300);
          _this.render();
          return $('#pane-right').animate({
            opacity: 1
          }, 200);
        });
      },
      render: function() {
        return this.$el.html(this.template(this.model.toJSON()));
      },
      iconChosen: function(e) {
        var icon;

        icon = $(e.currentTarget).find('.display-icon').attr('data-icon-name');
        return this.model.set('icon', icon);
      },
      nameUpdate: function(e) {
        var name;

        name = $(e.currentTarget).val();
        if (name.length < 19) {
          this.model.set('name-display', name);
          return $('#name-display').html(name);
        } else {
          return $('#input-name').val(name.substr(0, 18));
        }
      },
      descriptionUpdate: function(e) {
        var desc;

        desc = $(e.currentTarget).val();
        if (desc.length < 24) {
          return this.model.set('description', desc);
        } else {
          return $('#input-description').val(desc.substr(0, 23));
        }
      },
      saveReturn: function() {
        window.app.views.editPaneView.animateIn();
        return this.undelegateEvents();
      },
      keydownEvent: function(e) {
        return console.log(e);
      }
    });
    return EditControlView;
  });

}).call(this);
